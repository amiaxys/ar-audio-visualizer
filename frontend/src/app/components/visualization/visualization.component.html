<h2 id="title">{{ visualization.title }}</h2>
<div id="visualization-container">
  <button id="play" class="ar-btn" *ngIf="displayPlayBtn">Play</button>
  <a-scene
    embedded
    vr-mode-ui="enabled: false"
    arjs="sourceType: webcam; debugUIEnabled: false;"
    (click)="startVisualization()"
  >
    <a-marker
      marker
      type="pattern"
      url="../../../assets/pattern-music-solid.patt"
      emitevents="true"
      cursor="rayOrigin: mouse"
    >
      <ng-container *ngFor="let entity of freqEntities">
        <a-cylinder
          freq-entity
          *ngIf="entity.type === 'a-cylinder'"
          [attr.position]="entity.position"
          [attr.radius]="entity.radius"
          [attr.height]="entity.height"
          [attr.color]="entity.color"
        ></a-cylinder>
        <a-box
          freq-entity
          *ngIf="entity.type === 'a-box'"
          [attr.position]="entity.position"
          [attr.rotation]="entity.rotation"
          [attr.width]="entity.width"
          [attr.height]="entity.height"
          [attr.color]="entity.color"
        ></a-box>
        <a-sphere
          freq-entity
          *ngIf="entity.type === 'a-sphere'"
          [attr.position]="entity.position"
          [attr.radius]="entity.radius"
          [attr.color]="entity.color"
        ></a-sphere>
      </ng-container>
      <ng-container *ngFor="let entity of timeEntities">
        <a-cylinder
          time-entity
          *ngIf="entity.type === 'a-cylinder'"
          class="clickable"
          [attr.position]="entity.position"
          [attr.radius]="entity.radius"
          [attr.height]="entity.height"
          [attr.color]="entity.color"
        ></a-cylinder>
        <a-box
          time-entity
          *ngIf="entity.type === 'a-box'"
          class="clickable"
          [attr.position]="entity.position"
          [attr.rotation]="entity.rotation"
          [attr.width]="entity.width"
          [attr.height]="entity.height"
          [attr.color]="entity.color"
        ></a-box>
        <a-sphere
          time-entity
          *ngIf="entity.type === 'a-sphere'"
          class="clickable"
          [attr.position]="entity.position"
          [attr.radius]="entity.radius"
          [attr.color]="entity.color"
        ></a-sphere>
      </ng-container>
      <a-plane
        position="0 0 0"
        rotation="-90 0 0"
        width="4"
        height="4"
        [attr.color]="planeColor"
      ></a-plane>
      <a-sky color="blue"></a-sky>
    </a-marker>
    <a-entity camera look-controls></a-entity>
  </a-scene>

  <audio
    #audio
    controls
    crossorigin="use-credentials"
    [attr.src]="audioSource"
  ></audio>
</div>
