<script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>
<h1 id="title">{{ visualization.title }}</h1>
<iframe [src]="visualizationUrl | safe" id="visualization"></iframe>
<div id="visualization-container">
  <button id="play" class="ar-btn" *ngIf="displayPlayBtn">Play</button>
  <a-scene embedded arjs (click)="startVisualization()">
    <ng-container *ngFor="let entity of freqEntities">
      <a-cylinder
        *ngIf="entity.type === 'a-cylinder'"
        freq-entity
        [attr.position]="entity.position"
        [attr.radius]="entity.radius"
        [attr.height]="entity.height"
        [attr.color]="entity.color"
      ></a-cylinder>
      <a-box
        *ngIf="entity.type === 'a-box'"
        freq-entity
        [attr.position]="entity.position"
        [attr.rotation]="entity.rotation"
        [attr.width]="entity.width"
        [attr.height]="entity.height"
        [attr.color]="entity.color"
      ></a-box>
      <a-sphere
        *ngIf="entity.type === 'a-sphere'"
        freq-entity
        [attr.position]="entity.position"
        [attr.radius]="entity.radius"
        [attr.color]="entity.color"
      ></a-sphere>
    </ng-container>
    <a-sphere
      time-sphere
      *ngFor="let sphere of timeSpheres"
      [attr.position]="sphere.position"
      [attr.radius]="sphere.radius"
      [attr.color]="sphere.color"
    ></a-sphere>
    <a-sky [attr.color]="skyColor"></a-sky>
    <a-marker-camera preset="hiro"></a-marker-camera>
  </a-scene>
</div>

<audio
  #audio
  controls
  crossorigin="use-credentials"
  [attr.src]="audioSource"
></audio>
